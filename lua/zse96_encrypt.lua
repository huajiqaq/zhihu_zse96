local md5 = require("md5")
local bit32 = require("bit32")
local base64 = require("base64")

-- 初始密钥调度表
local _keySchedule = {0xe1,0xc6,0xfc,0xd7,0x71,0x61,0x5d,0x48,0xac,0xb9,0x85,0x9f,0x10,0x35,0x0f,0x2b,0xfe,0xa1,0xe7,0x55,0xb0,0x3c,0xde,0x97,0xc4,0x76,0x12,0x4c,0x86,0x6e,0x2f,0x0f,0x9f,0x3e,0x49,0x1a,0x29,0xac,0x8e,0xf8,0x65,0x08,0x5b,0xe1,0xd4,0xcb,0xba,0x7e,0x42,0x6b,0x97,0x87,0x01,0xcd,0x10,0xe7,0x3d,0x2d,0xdb,0xfc,0x50,0xa9,0x78,0xb8,0x34,0x9b,0x6f,0x02,0x88,0xf6,0x2f,0xa9,0x46,0x1f,0x78,0xc6,0xb6,0xe5,0xd6,0x58,0x69,0x45,0x3d,0x23,0x1c,0xef,0x0b,0xc6,0x90,0x83,0xbe,0xac,0x7d,0xf4,0x5b,0xd0,0xce,0xe9,0xa4,0xbc,0x5d,0x40,0x7a,0x61,0xf1,0xdf,0x28,0x3d,0x04,0x96,0x1e,0x81,0xa6,0xf5,0xcb,0x78,0xde,0x93,0xb7,0x30,0xea,0x51,0x09,0x63,0x28,0x4c,0x8d,0x19,0x79,0x5e,0xb9,0xa4,0xe5,0x13,0xc2,0x05,0xdb,0xfb,0x31,0x25,0x6c,0x8f,0x4d,0x92,0xba,0xdb,0x76,0xc9,0xfc,0x86,0xab,0x20,0x5b,0xe0,0x6a,0x0d,0x36,0x1e,0x9c,0x40,0x27,0x81,0x09,0x65,0x9a,0xdd,0x3c,0xb5,0x16,0x40,0xc1,0x73,0xae,0x58,0xfa,0xe3,0x02,0x18,0x2a,0x38,0x45,0x54,0x62,0x73,0x8d,0x9a,0xa9,0xb9,0xca,0xd7,0xe6,0xf2,0x8b,0x2c,0x1d,0x44,0x39,0xb2,0x96,0xd5,0x04,0x68,0xe5,0x5d,0xfd,0x77,0xa1,0xc4,0x14,0x06,0x81,0x96,0x6e,0x72,0x42,0x5b,0x2c,0x39,0xf9,0xd1,0xe9,0xb9,0xc9,0xa3,0x57,0x79,0xdf,0xfe,0xc2,0x02,0xed,0x1e,0xb6,0xa7,0x96,0x89,0x41,0x25,0x6a,0x3c,0xd5,0xb0,0x5f,0xea,0xaa,0x20,0xfa,0x84,0x78,0xc8,0x4b,0x17,0x9f,0x08,0x3e,0x6c};
-- S-Box
local _sBox = {0xbb,0xdb,0x76,0xc1,0xfa,0x87,0xa3,0x20,0x52,0xed,0x63,0x00,0x3e,0x19,0x95,0x49,0xd1,0xbd,0x52,0xe3,0xad,0x2d,0xfa,0x84,0x76,0xcf,0x45,0x1b,0x95,0x02,0x39,0x65,0x7a,0x57,0xbf,0xa6,0xe0,0x12,0xc5,0x0d,0xde,0xf6,0x36,0x2f,0x64,0x8f,0x43,0x9b,0xc7,0xe9,0xaf,0xba,0x50,0x4c,0x7f,0x64,0xf0,0xdf,0x25,0x3c,0x0a,0x92,0x16,0x87,0xfb,0xaf,0xe5,0x5f,0xbc,0x3f,0xd6,0x9e,0xc7,0x7c,0x12,0x4d,0x80,0x63,0x21,0x0a,0x88,0x29,0x1d,0x43,0x30,0xbf,0x98,0xdc,0x09,0x64,0xe7,0x56,0xf4,0x7f,0xab,0xc5,0xa0,0xf3,0xc2,0x71,0xda,0x90,0xb2,0x3e,0xe9,0x53,0x0a,0x65,0x2d,0x49,0x86,0x1e,0x2b,0x8f,0x0c,0x6b,0x97,0xd5,0x39,0xb4,0x19,0x47,0xcc,0x79,0xa6,0x52,0xff,0xe0,0x58,0x7d,0xd8,0xff,0xcd,0x03,0xeb,0x11,0xb3,0xa7,0x9d,0x87,0x4f,0x20,0x62,0x35,0xe9,0xcd,0xfe,0xdd,0x7e,0x68,0x59,0x47,0xa9,0xbf,0x84,0x9c,0x1c,0x3e,0x02,0x2b,0x6d,0x43,0x3e,0x27,0x18,0xe5,0x06,0xc7,0x90,0x85,0xbc,0xad,0x78,0xf0,0x52,0xd4,0x0a,0x1f,0x2d,0x3e,0x45,0x55,0x6b,0x72,0x8a,0x9e,0xa8,0xb6,0xc5,0xd4,0xe6,0xfd,0x39,0x92,0x66,0x05,0x82,0xf7,0x2f,0xa0,0x4e,0x17,0x78,0xc2,0xbc,0xeb,0xd4,0x50,0x19,0x07,0x8d,0x90,0x64,0x79,0x4f,0x5c,0x25,0x3e,0xf6,0xdc,0xe4,0xbb,0xc9,0xa9,0x9e,0x35,0x40,0x16,0x29,0xa4,0x80,0xf5,0x63,0x02,0x5a,0xe9,0xdf,0xc4,0xbf,0x72,0x4f,0x66,0x94,0x8d,0x02,0xc7,0x16,0xea,0x31,0x2e,0xdb,0xf3,0x5d,0xa8,0x75,0xb4}
-- 轮常量
local _roundConstants = { ['0'] = '09', ['1'] = '6E', ['2'] = '11', ['3'] = 'FC', ['4'] = '8C', ['5'] = '53', ['6'] = 'E8', ['7'] = '3B', ['8'] = '74', ['9'] = '95', ['10'] = 'C2', ['11'] = '28', ['12'] = 'D2', ['13'] = '46', ['14'] = 'B3', ['15'] = 'AB', ['16'] = '6D', ['17'] = '08', ['18'] = '75', ['19'] = '97', ['20'] = 'EB', ['21'] = '38', ['22'] = '87', ['23'] = '53', ['24'] = '16', ['25'] = 'F4', ['26'] = 'AD', ['27'] = '4F', ['28'] = 'BC', ['29'] = '26', ['30'] = 'D2', ['31'] = 'CD', ['32'] = '1E', ['33'] = '7A', ['34'] = '0E', ['35'] = 'EE', ['36'] = '97', ['37'] = '4C', ['38'] = 'F0', ['39'] = '28', ['40'] = '69', ['41'] = '82', ['42'] = 'DC', ['43'] = '35', ['44'] = 'C0', ['45'] = '5B', ['46'] = 'A7', ['47'] = 'B6', ['48'] = 'FC', ['49'] = '9D', ['50'] = 'E6', ['51'] = '02', ['52'] = '79', ['53'] = 'AB', ['54'] = '1B', ['55'] = 'C4', ['56'] = '85', ['57'] = '60', ['58'] = '3F', ['59'] = 'D5', ['60'] = '2D', ['61'] = 'B2', ['62'] = '4B', ['63'] = '5A', ['64'] = '8B', ['65'] = 'EC', ['66'] = '90', ['67'] = '7D', ['68'] = '04', ['69'] = 'D7', ['70'] = '62', ['71'] = 'B2', ['72'] = 'F0', ['73'] = '1E', ['74'] = '4B', ['75'] = 'A8', ['76'] = '57', ['77'] = 'C9', ['78'] = '30', ['79'] = '2A', ['80'] = '51', ['81'] = '32', ['82'] = '4A', ['83'] = 'A5', ['84'] = 'D0', ['85'] = '0E', ['86'] = 'BB', ['87'] = '68', ['88'] = '2C', ['89'] = 'CE', ['90'] = '9F', ['91'] = '76', ['92'] = '80', ['93'] = '1A', ['94'] = 'E8', ['95'] = 'FE', ['96'] = 'E3', ['97'] = '82', ['98'] = 'F6', ['99'] = '14', ['100'] = '62', ['101'] = 'B3', ['102'] = '0B', ['103'] = 'D1', ['104'] = '94', ['105'] = '76', ['106'] = '24', ['107'] = 'C2', ['108'] = '33', ['109'] = 'A2', ['110'] = '5B', ['111'] = '49', ['112'] = '3F', ['113'] = '54', ['114'] = '2C', ['115'] = 'CB', ['116'] = 'B1', ['117'] = '62', ['118'] = 'D1', ['119'] = '0B', ['120'] = '4B', ['121'] = 'AF', ['122'] = 'FB', ['123'] = '1A', ['124'] = 'E2', ['125'] = '74', ['126'] = '81', ['127'] = '94', ['128'] = '75', ['129'] = '17', ['130'] = '68', ['131'] = '85', ['132'] = 'F6', ['133'] = '2A', ['134'] = '95', ['135'] = '49', ['136'] = '07', ['137'] = 'E0', ['138'] = 'BF', ['139'] = '5F', ['140'] = 'AB', ['141'] = '34', ['142'] = 'C5', ['143'] = 'D6', ['144'] = '93', ['145'] = 'FC', ['146'] = '83', ['147'] = '6E', ['148'] = '1C', ['149'] = 'C6', ['150'] = '74', ['151'] = 'A2', ['152'] = 'E8', ['153'] = '0D', ['154'] = '58', ['155'] = 'BE', ['156'] = '47', ['157'] = 'DA', ['158'] = '22', ['159'] = '31', ['160'] = 'C9', ['161'] = 'AA', ['162'] = 'D9', ['163'] = '37', ['164'] = '43', ['165'] = '94', ['166'] = '2E', ['167'] = 'F8', ['168'] = 'BE', ['169'] = '59', ['170'] = '0A', ['171'] = 'E6', ['172'] = '14', ['173'] = '88', ['174'] = '79', ['175'] = '68', ['176'] = '22', ['177'] = '45', ['178'] = '3A', ['179'] = 'DD', ['180'] = 'A3', ['181'] = '7C', ['182'] = 'CF', ['183'] = '11', ['184'] = '57', ['185'] = 'B1', ['186'] = 'E8', ['187'] = '03', ['188'] = 'FD', ['189'] = '6C', ['190'] = '9E', ['191'] = '88', ['192'] = 'DC', ['193'] = 'B5', ['194'] = 'CD', ['195'] = '29', ['196'] = '56', ['197'] = '86', ['198'] = '3C', ['199'] = 'ED', ['200'] = 'AA', ['201'] = '4A', ['202'] = '1B', ['203'] = 'FB', ['204'] = '0D', ['205'] = '97', ['206'] = '65', ['207'] = '72', ['208'] = '4C', ['209'] = '28', ['210'] = '5D', ['211'] = 'B0', ['212'] = 'CF', ['213'] = '13', ['214'] = 'A0', ['215'] = '76', ['216'] = '35', ['217'] = 'D1', ['218'] = '82', ['219'] = '64', ['220'] = '95', ['221'] = '0E', ['222'] = 'FB', ['223'] = 'E8', ['224'] = 'B3', ['225'] = 'DE', ['226'] = 'A6', ['227'] = '40', ['228'] = '39', ['229'] = 'E2', ['230'] = '50', ['231'] = '86', ['232'] = 'CB', ['233'] = '2F', ['234'] = '70', ['235'] = '9C', ['236'] = '69', ['237'] = 'F3', ['238'] = '02', ['239'] = '1A', ['240'] = 'AF', ['241'] = 'C0', ['242'] = 'B4', ['243'] = '55', ['244'] = '20', ['245'] = 'FE', ['246'] = '49', ['247'] = '93', ['248'] = 'DE', ['249'] = '38', ['250'] = '61', ['251'] = '84', ['252'] = '76', ['253'] = 'E7', ['254'] = '1E', ['255'] = '01'}
local dict1 = { ['0'] = '0C1717DA', ['4'] = 'F08A8A36', ['8'] = 'C89A9A19', ['12'] = '3F9797DE', ['16'] = '574D4D35', ['20'] = 'F48C8C38', ['24'] = '72D6D65C', ['28'] = '1D6D6DFB', ['32'] = '4C8787CA', ['36'] = 'C5CBCBB5', ['40'] = '428F8FC9', ['44'] = '1C6868F4', ['48'] = 'D56B6B45', ['52'] = '52AFAFE9', ['56'] = '13F9F96D', ['60'] = '3CC8C804', ['64'] = '01B6B60F', ['68'] = 'D26F6F49', ['72'] = '6236367C', ['76'] = '270D0D75', ['80'] = '24D9D987', ['84'] = '982A2AF9', ['88'] = '61EFEF86', ['92'] = '7E020224', ['96'] = 'C6939317', ['100'] = '7309092D', ['104'] = '584A4A39', ['108'] = '106A6AF6', ['112'] = '3E9292D4', ['116'] = '448989C7', ['120'] = '11FFFF66', ['124'] = '534C4C30', ['128'] = 'D4696947', ['132'] = 'B3B9B9BD', ['136'] = 'DA626243', ['140'] = '9C57576A', ['144'] = '29DEDE80', ['148'] = 'AC37372A', ['152'] = '6A35357E', ['156'] = 'FE7272E4', ['160'] = '051B1BD5', ['164'] = '7CD8D854', ['168'] = 'F37979ED', ['172'] = 'B1BFBFB6', ['176'] = '389494DC', ['180'] = '7F07072E', ['184'] = 'B8B4B4BC', ['188'] = '2B010171', ['192'] = '35C1C102', ['196'] = '7AD5D55E', ['200'] = '77000022', ['204'] = '4B717191', ['208'] = '8DADAD9B', ['212'] = '6D3D3D7B', ['216'] = '196363FD', ['220'] = '75D1D152', ['224'] = '041919D7', ['228'] = '22DFDF89', ['232'] = '884444CC', ['236'] = 'AD303021', ['240'] = '84ACAC98', ['244'] = '26030377', ['248'] = 'B913131D', ['252'] = 'A7EDED55', ['256'] = '5DA0A0E1', ['260'] = 'AFE8E853', ['264'] = '603A3A76', ['268'] = '5B414131', ['272'] = '32C6C60C', ['276'] = '972D2DF5', ['280'] = 'DFF8F8A3', ['284'] = 'BBBBBBBB', ['288'] = 'E95353AD', ['292'] = '5E45453A', ['296'] = 'D1F6F6AF', ['300'] = '8E4242C4', ['304'] = '146C6CF8', ['308'] = '1A6565FE', ['312'] = '9D505061', ['316'] = 'FB7B7BEB', ['320'] = '156161F2', ['324'] = 'A1E6E65F', ['328'] = 'A8EAEA59', ['332'] = 'F983833D', ['336'] = '50A4A4EF', ['340'] = '6C383874', ['344'] = '68E4E48C', ['348'] = 'E329294D', ['352'] = 'C2CFCFB9', ['356'] = 'FD8D8D3B', ['360'] = 'CF989813', ['364'] = 'A4393927', ['368'] = '0BB1B101', ['372'] = '864E4EC8', ['376'] = 'D6F3F3A7', ['380'] = 'B01A1A16', ['384'] = 'CB919111', ['388'] = '65313172', ['392'] = '46737397', ['396'] = 'BA15151E', ['400'] = '498E8EC0', ['404'] = '230C0C70', ['408'] = 'DEF5F5AA', ['412'] = 'F87474EC', ['416'] = '319F9FD6', ['420'] = 'D96E6E40', ['424'] = 'E05A5AA6', ['428'] = 'EC5858A4', ['432'] = 'BC181814', ['436'] = '80AAAA96', ['440'] = '925F5F69', ['444'] = '2106067F', ['448'] = '30CACA06', ['452'] = 'E12F2F46', ['456'] = 'F67E7EE8', ['460'] = 'E7202042', ['464'] = '932C2CF0', ['468'] = 'CDC0C0B1', ['472'] = '379090D2', ['476'] = '2AD2D283', ['480'] = 'A034342F', ['484'] = '126666FC', ['488'] = '85A1A192', ['492'] = '94595967', ['496'] = '7804042C', ['500'] = '408484CF', ['504'] = 'C4C9C9B7', ['508'] = 'E62E2E48', ['512'] = 'EF27274E', ['516'] = 'DC67674A', ['520'] = '0FB8B803', ['524'] = 'A23F3F29', ['528'] = 'B6BEBEB8', ['532'] = '6FE7E78E', ['536'] = '2DD0D081', ['540'] = '9F2828F3', ['544'] = 'F286863C', ['548'] = '5146463F', ['552'] = '20D4D48F', ['556'] = 'A53B3B25', ['560'] = 'C79D9D15', ['564'] = '5AA2A2E3', ['568'] = 'F17F7FE6', ['572'] = 'D7FDFDA5', ['576'] = '4A8282C3', ['580'] = 'E25656AC', ['584'] = 'B41C1C18', ['588'] = 'CAC2C2B3', ['592'] = '70DADA56', ['596'] = 'F77070E2', ['600'] = '7B0B0B2B', ['604'] = '1BFBFB6B', ['608'] = '8CA8A894', ['612'] = 'C0C4C4BF', ['616'] = '34CCCC08', ['620'] = '874040C2', ['624'] = '5CA7A7EA', ['628'] = '995E5E60', ['632'] = '9B2121F1', ['636'] = '2CD7D78A', ['640'] = '962323F7', ['644'] = '67E0E082', ['648'] = '66EEEE88', ['652'] = '280A0A79', ['656'] = 'BEB2B2B4', ['660'] = 'ED5D5DAB', ['664'] = '091E1ED0', ['668'] = '9054546F', ['672'] = '834949CD', ['676'] = '06B3B307', ['680'] = 'DD606041', ['684'] = '3B9B9BDB', ['688'] = '79D3D35D', ['692'] = 'E824244C', ['696'] = 'C9CECEB0', ['700'] = 'DBF1F1A1', ['704'] = 'C196961F', ['708'] = 'EB2B2B4B', ['712'] = 'CE95951A', ['716'] = 'FA85853E', ['720'] = 'AEE5E55A', ['724'] = '4E75759A', ['728'] = '39C3C30D', ['732'] = '339999DD', ['736'] = '63E9E98D', ['740'] = 'D064644F', ['744'] = '54A9A9E7', ['748'] = '6EE2E284', ['752'] = '369E9ED8', ['756'] = 'B7B0B0B2', ['760'] = 'A3ECEC50', ['764'] = 'CCC7C7BA', ['768'] = '4D8080C1', ['772'] = '17F0F062', ['776'] = '08BABA09', ['780'] = 'EA5555AE', ['784'] = 'A93E3E20', ['788'] = '03BCBC00', ['792'] = '955B5B65', ['796'] = 'BD1D1D1B', ['800'] = '487A7A99', ['804'] = 'ABE1E151', ['808'] = '814F4FC6', ['812'] = 'B216161C', ['816'] = '760E0E28', ['820'] = '7DDDDD5B', ['824'] = '1FF7F76E', ['828'] = 'E45C5CA8', ['832'] = '0D1010D1', ['836'] = '16FEFE68', ['840'] = '82A6A69C', ['844'] = '0EB5B50A', ['848'] = '4F787893', ['852'] = '710F0F26', ['856'] = '89A3A39D', ['860'] = 'D3FCFCA0', ['864'] = 'E55151A2', ['868'] = 'B5111112', ['872'] = '56434337', ['876'] = '6BEBEB8B', ['880'] = '8AA5A59E', ['884'] = '6933337D', ['888'] = '25DBDB85', ['892'] = 'FF7777EE', ['896'] = '643C3C78', ['900'] = '18F4F46C', ['904'] = '3AC5C50E', ['908'] = '74DCDC58', ['912'] = 'D8FAFAA9', ['916'] = 'C39C9C10', ['920'] = '8B4B4BCB', ['924'] = 'FC888834', ['928'] = 'BFB7B7BE', ['932'] = '001414DF', ['936'] = '912626FF', ['940'] = '55ABABE5', ['944'] = 'F5818132', ['948'] = '3DCDCD0B', ['952'] = 'EE222244', ['956'] = '1EF2F264', ['960'] = '0A1212D3', ['964'] = '8F4747CE', ['968'] = '2F080873', ['972'] = '437C7C90', ['976'] = 'A6E3E357', ['980'] = '9A525263', ['984'] = '477D7D95', ['988'] = '4176769F', ['992'] = '59AEAEE0', ['996'] = '458B8BC5', ['1000'] = 'AA323223', ['1004'] = '07BDBD05', ['1008'] = '021F1FD9', ['1012'] = '9E2525FA', ['1016'] = '5F484833', ['1020'] = '2E05057A'}
local dict2 = { ['0'] = 'DA0C1717', ['4'] = '36F08A8A', ['8'] = '19C89A9A', ['12'] = 'DE3F9797', ['16'] = '35574D4D', ['20'] = '38F48C8C', ['24'] = '5C72D6D6', ['28'] = 'FB1D6D6D', ['32'] = 'CA4C8787', ['36'] = 'B5C5CBCB', ['40'] = 'C9428F8F', ['44'] = 'F41C6868', ['48'] = '45D56B6B', ['52'] = 'E952AFAF', ['56'] = '6D13F9F9', ['60'] = '043CC8C8', ['64'] = '0F01B6B6', ['68'] = '49D26F6F', ['72'] = '7C623636', ['76'] = '75270D0D', ['80'] = '8724D9D9', ['84'] = 'F9982A2A', ['88'] = '8661EFEF', ['92'] = '247E0202', ['96'] = '17C69393', ['100'] = '2D730909', ['104'] = '39584A4A', ['108'] = 'F6106A6A', ['112'] = 'D43E9292', ['116'] = 'C7448989', ['120'] = '6611FFFF', ['124'] = '30534C4C', ['128'] = '47D46969', ['132'] = 'BDB3B9B9', ['136'] = '43DA6262', ['140'] = '6A9C5757', ['144'] = '8029DEDE', ['148'] = '2AAC3737', ['152'] = '7E6A3535', ['156'] = 'E4FE7272', ['160'] = 'D5051B1B', ['164'] = '547CD8D8', ['168'] = 'EDF37979', ['172'] = 'B6B1BFBF', ['176'] = 'DC389494', ['180'] = '2E7F0707', ['184'] = 'BCB8B4B4', ['188'] = '712B0101', ['192'] = '0235C1C1', ['196'] = '5E7AD5D5', ['200'] = '22770000', ['204'] = '914B7171', ['208'] = '9B8DADAD', ['212'] = '7B6D3D3D', ['216'] = 'FD196363', ['220'] = '5275D1D1', ['224'] = 'D7041919', ['228'] = '8922DFDF', ['232'] = 'CC884444', ['236'] = '21AD3030', ['240'] = '9884ACAC', ['244'] = '77260303', ['248'] = '1DB91313', ['252'] = '55A7EDED', ['256'] = 'E15DA0A0', ['260'] = '53AFE8E8', ['264'] = '76603A3A', ['268'] = '315B4141', ['272'] = '0C32C6C6', ['276'] = 'F5972D2D', ['280'] = 'A3DFF8F8', ['284'] = 'BBBBBBBB', ['288'] = 'ADE95353', ['292'] = '3A5E4545', ['296'] = 'AFD1F6F6', ['300'] = 'C48E4242', ['304'] = 'F8146C6C', ['308'] = 'FE1A6565', ['312'] = '619D5050', ['316'] = 'EBFB7B7B', ['320'] = 'F2156161', ['324'] = '5FA1E6E6', ['328'] = '59A8EAEA', ['332'] = '3DF98383', ['336'] = 'EF50A4A4', ['340'] = '746C3838', ['344'] = '8C68E4E4', ['348'] = '4DE32929', ['352'] = 'B9C2CFCF', ['356'] = '3BFD8D8D', ['360'] = '13CF9898', ['364'] = '27A43939', ['368'] = '010BB1B1', ['372'] = 'C8864E4E', ['376'] = 'A7D6F3F3', ['380'] = '16B01A1A', ['384'] = '11CB9191', ['388'] = '72653131', ['392'] = '97467373', ['396'] = '1EBA1515', ['400'] = 'C0498E8E', ['404'] = '70230C0C', ['408'] = 'AADEF5F5', ['412'] = 'ECF87474', ['416'] = 'D6319F9F', ['420'] = '40D96E6E', ['424'] = 'A6E05A5A', ['428'] = 'A4EC5858', ['432'] = '14BC1818', ['436'] = '9680AAAA', ['440'] = '69925F5F', ['444'] = '7F210606', ['448'] = '0630CACA', ['452'] = '46E12F2F', ['456'] = 'E8F67E7E', ['460'] = '42E72020', ['464'] = 'F0932C2C', ['468'] = 'B1CDC0C0', ['472'] = 'D2379090', ['476'] = '832AD2D2', ['480'] = '2FA03434', ['484'] = 'FC126666', ['488'] = '9285A1A1', ['492'] = '67945959', ['496'] = '2C780404', ['500'] = 'CF408484', ['504'] = 'B7C4C9C9', ['508'] = '48E62E2E', ['512'] = '4EEF2727', ['516'] = '4ADC6767', ['520'] = '030FB8B8', ['524'] = '29A23F3F', ['528'] = 'B8B6BEBE', ['532'] = '8E6FE7E7', ['536'] = '812DD0D0', ['540'] = 'F39F2828', ['544'] = '3CF28686', ['548'] = '3F514646', ['552'] = '8F20D4D4', ['556'] = '25A53B3B', ['560'] = '15C79D9D', ['564'] = 'E35AA2A2', ['568'] = 'E6F17F7F', ['572'] = 'A5D7FDFD', ['576'] = 'C34A8282', ['580'] = 'ACE25656', ['584'] = '18B41C1C', ['588'] = 'B3CAC2C2', ['592'] = '5670DADA', ['596'] = 'E2F77070', ['600'] = '2B7B0B0B', ['604'] = '6B1BFBFB', ['608'] = '948CA8A8', ['612'] = 'BFC0C4C4', ['616'] = '0834CCCC', ['620'] = 'C2874040', ['624'] = 'EA5CA7A7', ['628'] = '60995E5E', ['632'] = 'F19B2121', ['636'] = '8A2CD7D7', ['640'] = 'F7962323', ['644'] = '8267E0E0', ['648'] = '8866EEEE', ['652'] = '79280A0A', ['656'] = 'B4BEB2B2', ['660'] = 'ABED5D5D', ['664'] = 'D0091E1E', ['668'] = '6F905454', ['672'] = 'CD834949', ['676'] = '0706B3B3', ['680'] = '41DD6060', ['684'] = 'DB3B9B9B', ['688'] = '5D79D3D3', ['692'] = '4CE82424', ['696'] = 'B0C9CECE', ['700'] = 'A1DBF1F1', ['704'] = '1FC19696', ['708'] = '4BEB2B2B', ['712'] = '1ACE9595', ['716'] = '3EFA8585', ['720'] = '5AAEE5E5', ['724'] = '9A4E7575', ['728'] = '0D39C3C3', ['732'] = 'DD339999', ['736'] = '8D63E9E9', ['740'] = '4FD06464', ['744'] = 'E754A9A9', ['748'] = '846EE2E2', ['752'] = 'D8369E9E', ['756'] = 'B2B7B0B0', ['760'] = '50A3ECEC', ['764'] = 'BACCC7C7', ['768'] = 'C14D8080', ['772'] = '6217F0F0', ['776'] = '0908BABA', ['780'] = 'AEEA5555', ['784'] = '20A93E3E', ['788'] = '0003BCBC', ['792'] = '65955B5B', ['796'] = '1BBD1D1D', ['800'] = '99487A7A', ['804'] = '51ABE1E1', ['808'] = 'C6814F4F', ['812'] = '1CB21616', ['816'] = '28760E0E', ['820'] = '5B7DDDDD', ['824'] = '6E1FF7F7', ['828'] = 'A8E45C5C', ['832'] = 'D10D1010', ['836'] = '6816FEFE', ['840'] = '9C82A6A6', ['844'] = '0A0EB5B5', ['848'] = '934F7878', ['852'] = '26710F0F', ['856'] = '9D89A3A3', ['860'] = 'A0D3FCFC', ['864'] = 'A2E55151', ['868'] = '12B51111', ['872'] = '37564343', ['876'] = '8B6BEBEB', ['880'] = '9E8AA5A5', ['884'] = '7D693333', ['888'] = '8525DBDB', ['892'] = 'EEFF7777', ['896'] = '78643C3C', ['900'] = '6C18F4F4', ['904'] = '0E3AC5C5', ['908'] = '5874DCDC', ['912'] = 'A9D8FAFA', ['916'] = '10C39C9C', ['920'] = 'CB8B4B4B', ['924'] = '34FC8888', ['928'] = 'BEBFB7B7', ['932'] = 'DF001414', ['936'] = 'FF912626', ['940'] = 'E555ABAB', ['944'] = '32F58181', ['948'] = '0B3DCDCD', ['952'] = '44EE2222', ['956'] = '641EF2F2', ['960'] = 'D30A1212', ['964'] = 'CE8F4747', ['968'] = '732F0808', ['972'] = '90437C7C', ['976'] = '57A6E3E3', ['980'] = '639A5252', ['984'] = '95477D7D', ['988'] = '9F417676', ['992'] = 'E059AEAE', ['996'] = 'C5458B8B', ['1000'] = '23AA3232', ['1004'] = '0507BDBD', ['1008'] = 'D9021F1F', ['1012'] = 'FA9E2525', ['1016'] = '335F4848', ['1020'] = '7A2E0505'}
local dict3 = { ['0'] = '17DA0C17', ['4'] = '8A36F08A', ['8'] = '9A19C89A', ['12'] = '97DE3F97', ['16'] = '4D35574D', ['20'] = '8C38F48C', ['24'] = 'D65C72D6', ['28'] = '6DFB1D6D', ['32'] = '87CA4C87', ['36'] = 'CBB5C5CB', ['40'] = '8FC9428F', ['44'] = '68F41C68', ['48'] = '6B45D56B', ['52'] = 'AFE952AF', ['56'] = 'F96D13F9', ['60'] = 'C8043CC8', ['64'] = 'B60F01B6', ['68'] = '6F49D26F', ['72'] = '367C6236', ['76'] = '0D75270D', ['80'] = 'D98724D9', ['84'] = '2AF9982A', ['88'] = 'EF8661EF', ['92'] = '02247E02', ['96'] = '9317C693', ['100'] = '092D7309', ['104'] = '4A39584A', ['108'] = '6AF6106A', ['112'] = '92D43E92', ['116'] = '89C74489', ['120'] = 'FF6611FF', ['124'] = '4C30534C', ['128'] = '6947D469', ['132'] = 'B9BDB3B9', ['136'] = '6243DA62', ['140'] = '576A9C57', ['144'] = 'DE8029DE', ['148'] = '372AAC37', ['152'] = '357E6A35', ['156'] = '72E4FE72', ['160'] = '1BD5051B', ['164'] = 'D8547CD8', ['168'] = '79EDF379', ['172'] = 'BFB6B1BF', ['176'] = '94DC3894', ['180'] = '072E7F07', ['184'] = 'B4BCB8B4', ['188'] = '01712B01', ['192'] = 'C10235C1', ['196'] = 'D55E7AD5', ['200'] = '00227700', ['204'] = '71914B71', ['208'] = 'AD9B8DAD', ['212'] = '3D7B6D3D', ['216'] = '63FD1963', ['220'] = 'D15275D1', ['224'] = '19D70419', ['228'] = 'DF8922DF', ['232'] = '44CC8844', ['236'] = '3021AD30', ['240'] = 'AC9884AC', ['244'] = '03772603', ['248'] = '131DB913', ['252'] = 'ED55A7ED', ['256'] = 'A0E15DA0', ['260'] = 'E853AFE8', ['264'] = '3A76603A', ['268'] = '41315B41', ['272'] = 'C60C32C6', ['276'] = '2DF5972D', ['280'] = 'F8A3DFF8', ['284'] = 'BBBBBBBB', ['288'] = '53ADE953', ['292'] = '453A5E45', ['296'] = 'F6AFD1F6', ['300'] = '42C48E42', ['304'] = '6CF8146C', ['308'] = '65FE1A65', ['312'] = '50619D50', ['316'] = '7BEBFB7B', ['320'] = '61F21561', ['324'] = 'E65FA1E6', ['328'] = 'EA59A8EA', ['332'] = '833DF983', ['336'] = 'A4EF50A4', ['340'] = '38746C38', ['344'] = 'E48C68E4', ['348'] = '294DE329', ['352'] = 'CFB9C2CF', ['356'] = '8D3BFD8D', ['360'] = '9813CF98', ['364'] = '3927A439', ['368'] = 'B1010BB1', ['372'] = '4EC8864E', ['376'] = 'F3A7D6F3', ['380'] = '1A16B01A', ['384'] = '9111CB91', ['388'] = '31726531', ['392'] = '73974673', ['396'] = '151EBA15', ['400'] = '8EC0498E', ['404'] = '0C70230C', ['408'] = 'F5AADEF5', ['412'] = '74ECF874', ['416'] = '9FD6319F', ['420'] = '6E40D96E', ['424'] = '5AA6E05A', ['428'] = '58A4EC58', ['432'] = '1814BC18', ['436'] = 'AA9680AA', ['440'] = '5F69925F', ['444'] = '067F2106', ['448'] = 'CA0630CA', ['452'] = '2F46E12F', ['456'] = '7EE8F67E', ['460'] = '2042E720', ['464'] = '2CF0932C', ['468'] = 'C0B1CDC0', ['472'] = '90D23790', ['476'] = 'D2832AD2', ['480'] = '342FA034', ['484'] = '66FC1266', ['488'] = 'A19285A1', ['492'] = '59679459', ['496'] = '042C7804', ['500'] = '84CF4084', ['504'] = 'C9B7C4C9', ['508'] = '2E48E62E', ['512'] = '274EEF27', ['516'] = '674ADC67', ['520'] = 'B8030FB8', ['524'] = '3F29A23F', ['528'] = 'BEB8B6BE', ['532'] = 'E78E6FE7', ['536'] = 'D0812DD0', ['540'] = '28F39F28', ['544'] = '863CF286', ['548'] = '463F5146', ['552'] = 'D48F20D4', ['556'] = '3B25A53B', ['560'] = '9D15C79D', ['564'] = 'A2E35AA2', ['568'] = '7FE6F17F', ['572'] = 'FDA5D7FD', ['576'] = '82C34A82', ['580'] = '56ACE256', ['584'] = '1C18B41C', ['588'] = 'C2B3CAC2', ['592'] = 'DA5670DA', ['596'] = '70E2F770', ['600'] = '0B2B7B0B', ['604'] = 'FB6B1BFB', ['608'] = 'A8948CA8', ['612'] = 'C4BFC0C4', ['616'] = 'CC0834CC', ['620'] = '40C28740', ['624'] = 'A7EA5CA7', ['628'] = '5E60995E', ['632'] = '21F19B21', ['636'] = 'D78A2CD7', ['640'] = '23F79623', ['644'] = 'E08267E0', ['648'] = 'EE8866EE', ['652'] = '0A79280A', ['656'] = 'B2B4BEB2', ['660'] = '5DABED5D', ['664'] = '1ED0091E', ['668'] = '546F9054', ['672'] = '49CD8349', ['676'] = 'B30706B3', ['680'] = '6041DD60', ['684'] = '9BDB3B9B', ['688'] = 'D35D79D3', ['692'] = '244CE824', ['696'] = 'CEB0C9CE', ['700'] = 'F1A1DBF1', ['704'] = '961FC196', ['708'] = '2B4BEB2B', ['712'] = '951ACE95', ['716'] = '853EFA85', ['720'] = 'E55AAEE5', ['724'] = '759A4E75', ['728'] = 'C30D39C3', ['732'] = '99DD3399', ['736'] = 'E98D63E9', ['740'] = '644FD064', ['744'] = 'A9E754A9', ['748'] = 'E2846EE2', ['752'] = '9ED8369E', ['756'] = 'B0B2B7B0', ['760'] = 'EC50A3EC', ['764'] = 'C7BACCC7', ['768'] = '80C14D80', ['772'] = 'F06217F0', ['776'] = 'BA0908BA', ['780'] = '55AEEA55', ['784'] = '3E20A93E', ['788'] = 'BC0003BC', ['792'] = '5B65955B', ['796'] = '1D1BBD1D', ['800'] = '7A99487A', ['804'] = 'E151ABE1', ['808'] = '4FC6814F', ['812'] = '161CB216', ['816'] = '0E28760E', ['820'] = 'DD5B7DDD', ['824'] = 'F76E1FF7', ['828'] = '5CA8E45C', ['832'] = '10D10D10', ['836'] = 'FE6816FE', ['840'] = 'A69C82A6', ['844'] = 'B50A0EB5', ['848'] = '78934F78', ['852'] = '0F26710F', ['856'] = 'A39D89A3', ['860'] = 'FCA0D3FC', ['864'] = '51A2E551', ['868'] = '1112B511', ['872'] = '43375643', ['876'] = 'EB8B6BEB', ['880'] = 'A59E8AA5', ['884'] = '337D6933', ['888'] = 'DB8525DB', ['892'] = '77EEFF77', ['896'] = '3C78643C', ['900'] = 'F46C18F4', ['904'] = 'C50E3AC5', ['908'] = 'DC5874DC', ['912'] = 'FAA9D8FA', ['916'] = '9C10C39C', ['920'] = '4BCB8B4B', ['924'] = '8834FC88', ['928'] = 'B7BEBFB7', ['932'] = '14DF0014', ['936'] = '26FF9126', ['940'] = 'ABE555AB', ['944'] = '8132F581', ['948'] = 'CD0B3DCD', ['952'] = '2244EE22', ['956'] = 'F2641EF2', ['960'] = '12D30A12', ['964'] = '47CE8F47', ['968'] = '08732F08', ['972'] = '7C90437C', ['976'] = 'E357A6E3', ['980'] = '52639A52', ['984'] = '7D95477D', ['988'] = '769F4176', ['992'] = 'AEE059AE', ['996'] = '8BC5458B', ['1000'] = '3223AA32', ['1004'] = 'BD0507BD', ['1008'] = '1FD9021F', ['1012'] = '25FA9E25', ['1016'] = '48335F48', ['1020'] = '057A2E05'}
local dict4 = { ['0'] = '1717DA0C', ['4'] = '8A8A36F0', ['8'] = '9A9A19C8', ['12'] = '9797DE3F', ['16'] = '4D4D3557', ['20'] = '8C8C38F4', ['24'] = 'D6D65C72', ['28'] = '6D6DFB1D', ['32'] = '8787CA4C', ['36'] = 'CBCBB5C5', ['40'] = '8F8FC942', ['44'] = '6868F41C', ['48'] = '6B6B45D5', ['52'] = 'AFAFE952', ['56'] = 'F9F96D13', ['60'] = 'C8C8043C', ['64'] = 'B6B60F01', ['68'] = '6F6F49D2', ['72'] = '36367C62', ['76'] = '0D0D7527', ['80'] = 'D9D98724', ['84'] = '2A2AF998', ['88'] = 'EFEF8661', ['92'] = '0202247E', ['96'] = '939317C6', ['100'] = '09092D73', ['104'] = '4A4A3958', ['108'] = '6A6AF610', ['112'] = '9292D43E', ['116'] = '8989C744', ['120'] = 'FFFF6611', ['124'] = '4C4C3053', ['128'] = '696947D4', ['132'] = 'B9B9BDB3', ['136'] = '626243DA', ['140'] = '57576A9C', ['144'] = 'DEDE8029', ['148'] = '37372AAC', ['152'] = '35357E6A', ['156'] = '7272E4FE', ['160'] = '1B1BD505', ['164'] = 'D8D8547C', ['168'] = '7979EDF3', ['172'] = 'BFBFB6B1', ['176'] = '9494DC38', ['180'] = '07072E7F', ['184'] = 'B4B4BCB8', ['188'] = '0101712B', ['192'] = 'C1C10235', ['196'] = 'D5D55E7A', ['200'] = '00002277', ['204'] = '7171914B', ['208'] = 'ADAD9B8D', ['212'] = '3D3D7B6D', ['216'] = '6363FD19', ['220'] = 'D1D15275', ['224'] = '1919D704', ['228'] = 'DFDF8922', ['232'] = '4444CC88', ['236'] = '303021AD', ['240'] = 'ACAC9884', ['244'] = '03037726', ['248'] = '13131DB9', ['252'] = 'EDED55A7', ['256'] = 'A0A0E15D', ['260'] = 'E8E853AF', ['264'] = '3A3A7660', ['268'] = '4141315B', ['272'] = 'C6C60C32', ['276'] = '2D2DF597', ['280'] = 'F8F8A3DF', ['284'] = 'BBBBBBBB', ['288'] = '5353ADE9', ['292'] = '45453A5E', ['296'] = 'F6F6AFD1', ['300'] = '4242C48E', ['304'] = '6C6CF814', ['308'] = '6565FE1A', ['312'] = '5050619D', ['316'] = '7B7BEBFB', ['320'] = '6161F215', ['324'] = 'E6E65FA1', ['328'] = 'EAEA59A8', ['332'] = '83833DF9', ['336'] = 'A4A4EF50', ['340'] = '3838746C', ['344'] = 'E4E48C68', ['348'] = '29294DE3', ['352'] = 'CFCFB9C2', ['356'] = '8D8D3BFD', ['360'] = '989813CF', ['364'] = '393927A4', ['368'] = 'B1B1010B', ['372'] = '4E4EC886', ['376'] = 'F3F3A7D6', ['380'] = '1A1A16B0', ['384'] = '919111CB', ['388'] = '31317265', ['392'] = '73739746', ['396'] = '15151EBA', ['400'] = '8E8EC049', ['404'] = '0C0C7023', ['408'] = 'F5F5AADE', ['412'] = '7474ECF8', ['416'] = '9F9FD631', ['420'] = '6E6E40D9', ['424'] = '5A5AA6E0', ['428'] = '5858A4EC', ['432'] = '181814BC', ['436'] = 'AAAA9680', ['440'] = '5F5F6992', ['444'] = '06067F21', ['448'] = 'CACA0630', ['452'] = '2F2F46E1', ['456'] = '7E7EE8F6', ['460'] = '202042E7', ['464'] = '2C2CF093', ['468'] = 'C0C0B1CD', ['472'] = '9090D237', ['476'] = 'D2D2832A', ['480'] = '34342FA0', ['484'] = '6666FC12', ['488'] = 'A1A19285', ['492'] = '59596794', ['496'] = '04042C78', ['500'] = '8484CF40', ['504'] = 'C9C9B7C4', ['508'] = '2E2E48E6', ['512'] = '27274EEF', ['516'] = '67674ADC', ['520'] = 'B8B8030F', ['524'] = '3F3F29A2', ['528'] = 'BEBEB8B6', ['532'] = 'E7E78E6F', ['536'] = 'D0D0812D', ['540'] = '2828F39F', ['544'] = '86863CF2', ['548'] = '46463F51', ['552'] = 'D4D48F20', ['556'] = '3B3B25A5', ['560'] = '9D9D15C7', ['564'] = 'A2A2E35A', ['568'] = '7F7FE6F1', ['572'] = 'FDFDA5D7', ['576'] = '8282C34A', ['580'] = '5656ACE2', ['584'] = '1C1C18B4', ['588'] = 'C2C2B3CA', ['592'] = 'DADA5670', ['596'] = '7070E2F7', ['600'] = '0B0B2B7B', ['604'] = 'FBFB6B1B', ['608'] = 'A8A8948C', ['612'] = 'C4C4BFC0', ['616'] = 'CCCC0834', ['620'] = '4040C287', ['624'] = 'A7A7EA5C', ['628'] = '5E5E6099', ['632'] = '2121F19B', ['636'] = 'D7D78A2C', ['640'] = '2323F796', ['644'] = 'E0E08267', ['648'] = 'EEEE8866', ['652'] = '0A0A7928', ['656'] = 'B2B2B4BE', ['660'] = '5D5DABED', ['664'] = '1E1ED009', ['668'] = '54546F90', ['672'] = '4949CD83', ['676'] = 'B3B30706', ['680'] = '606041DD', ['684'] = '9B9BDB3B', ['688'] = 'D3D35D79', ['692'] = '24244CE8', ['696'] = 'CECEB0C9', ['700'] = 'F1F1A1DB', ['704'] = '96961FC1', ['708'] = '2B2B4BEB', ['712'] = '95951ACE', ['716'] = '85853EFA', ['720'] = 'E5E55AAE', ['724'] = '75759A4E', ['728'] = 'C3C30D39', ['732'] = '9999DD33', ['736'] = 'E9E98D63', ['740'] = '64644FD0', ['744'] = 'A9A9E754', ['748'] = 'E2E2846E', ['752'] = '9E9ED836', ['756'] = 'B0B0B2B7', ['760'] = 'ECEC50A3', ['764'] = 'C7C7BACC', ['768'] = '8080C14D', ['772'] = 'F0F06217', ['776'] = 'BABA0908', ['780'] = '5555AEEA', ['784'] = '3E3E20A9', ['788'] = 'BCBC0003', ['792'] = '5B5B6595', ['796'] = '1D1D1BBD', ['800'] = '7A7A9948', ['804'] = 'E1E151AB', ['808'] = '4F4FC681', ['812'] = '16161CB2', ['816'] = '0E0E2876', ['820'] = 'DDDD5B7D', ['824'] = 'F7F76E1F', ['828'] = '5C5CA8E4', ['832'] = '1010D10D', ['836'] = 'FEFE6816', ['840'] = 'A6A69C82', ['844'] = 'B5B50A0E', ['848'] = '7878934F', ['852'] = '0F0F2671', ['856'] = 'A3A39D89', ['860'] = 'FCFCA0D3', ['864'] = '5151A2E5', ['868'] = '111112B5', ['872'] = '43433756', ['876'] = 'EBEB8B6B', ['880'] = 'A5A59E8A', ['884'] = '33337D69', ['888'] = 'DBDB8525', ['892'] = '7777EEFF', ['896'] = '3C3C7864', ['900'] = 'F4F46C18', ['904'] = 'C5C50E3A', ['908'] = 'DCDC5874', ['912'] = 'FAFAA9D8', ['916'] = '9C9C10C3', ['920'] = '4B4BCB8B', ['924'] = '888834FC', ['928'] = 'B7B7BEBF', ['932'] = '1414DF00', ['936'] = '2626FF91', ['940'] = 'ABABE555', ['944'] = '818132F5', ['948'] = 'CDCD0B3D', ['952'] = '222244EE', ['956'] = 'F2F2641E', ['960'] = '1212D30A', ['964'] = '4747CE8F', ['968'] = '0808732F', ['972'] = '7C7C9043', ['976'] = 'E3E357A6', ['980'] = '5252639A', ['984'] = '7D7D9547', ['988'] = '76769F41', ['992'] = 'AEAEE059', ['996'] = '8B8BC545', ['1000'] = '323223AA', ['1004'] = 'BDBD0507', ['1008'] = '1F1FD902', ['1012'] = '2525FA9E', ['1016'] = '4848335F', ['1020'] = '05057A2E'}
local dict5 = { ['0'] = '17', ['1'] = '8A', ['2'] = '9A', ['3'] = '97', ['4'] = '4D', ['5'] = '8C', ['6'] = 'D6', ['7'] = '6D', ['8'] = '87', ['9'] = 'CB', ['10'] = '8F', ['11'] = '68', ['12'] = '6B', ['13'] = 'AF', ['14'] = 'F9', ['15'] = 'C8', ['16'] = 'B6', ['17'] = '6F', ['18'] = '36', ['19'] = '0D', ['20'] = 'D9', ['21'] = '2A', ['22'] = 'EF', ['23'] = '02', ['24'] = '93', ['25'] = '09', ['26'] = '4A', ['27'] = '6A', ['28'] = '92', ['29'] = '89', ['30'] = 'FF', ['31'] = '4C', ['32'] = '69', ['33'] = 'B9', ['34'] = '62', ['35'] = '57', ['36'] = 'DE', ['37'] = '37', ['38'] = '35', ['39'] = '72', ['40'] = '1B', ['41'] = 'D8', ['42'] = '79', ['43'] = 'BF', ['44'] = '94', ['45'] = '07', ['46'] = 'B4', ['47'] = '01', ['48'] = 'C1', ['49'] = 'D5', ['50'] = '00', ['51'] = '71', ['52'] = 'AD', ['53'] = '3D', ['54'] = '63', ['55'] = 'D1', ['56'] = '19', ['57'] = 'DF', ['58'] = '44', ['59'] = '30', ['60'] = 'AC', ['61'] = '03', ['62'] = '13', ['63'] = 'ED', ['64'] = 'A0', ['65'] = 'E8', ['66'] = '3A', ['67'] = '41', ['68'] = 'C6', ['69'] = '2D', ['70'] = 'F8', ['71'] = 'BB', ['72'] = '53', ['73'] = '45', ['74'] = 'F6', ['75'] = '42', ['76'] = '6C', ['77'] = '65', ['78'] = '50', ['79'] = '7B', ['80'] = '61', ['81'] = 'E6', ['82'] = 'EA', ['83'] = '83', ['84'] = 'A4', ['85'] = '38', ['86'] = 'E4', ['87'] = '29', ['88'] = 'CF', ['89'] = '8D', ['90'] = '98', ['91'] = '39', ['92'] = 'B1', ['93'] = '4E', ['94'] = 'F3', ['95'] = '1A', ['96'] = '91', ['97'] = '31', ['98'] = '73', ['99'] = '15', ['100'] = '8E', ['101'] = '0C', ['102'] = 'F5', ['103'] = '74', ['104'] = '9F', ['105'] = '6E', ['106'] = '5A', ['107'] = '58', ['108'] = '18', ['109'] = 'AA', ['110'] = '5F', ['111'] = '06', ['112'] = 'CA', ['113'] = '2F', ['114'] = '7E', ['115'] = '20', ['116'] = '2C', ['117'] = 'C0', ['118'] = '90', ['119'] = 'D2', ['120'] = '34', ['121'] = '66', ['122'] = 'A1', ['123'] = '59', ['124'] = '04', ['125'] = '84', ['126'] = 'C9', ['127'] = '2E', ['128'] = '27', ['129'] = '67', ['130'] = 'B8', ['131'] = '3F', ['132'] = 'BE', ['133'] = 'E7', ['134'] = 'D0', ['135'] = '28', ['136'] = '86', ['137'] = '46', ['138'] = 'D4', ['139'] = '3B', ['140'] = '9D', ['141'] = 'A2', ['142'] = '7F', ['143'] = 'FD', ['144'] = '82', ['145'] = '56', ['146'] = '1C', ['147'] = 'C2', ['148'] = 'DA', ['149'] = '70', ['150'] = '0B', ['151'] = 'FB', ['152'] = 'A8', ['153'] = 'C4', ['154'] = 'CC', ['155'] = '40', ['156'] = 'A7', ['157'] = '5E', ['158'] = '21', ['159'] = 'D7', ['160'] = '23', ['161'] = 'E0', ['162'] = 'EE', ['163'] = '0A', ['164'] = 'B2', ['165'] = '5D', ['166'] = '1E', ['167'] = '54', ['168'] = '49', ['169'] = 'B3', ['170'] = '60', ['171'] = '9B', ['172'] = 'D3', ['173'] = '24', ['174'] = 'CE', ['175'] = 'F1', ['176'] = '96', ['177'] = '2B', ['178'] = '95', ['179'] = '85', ['180'] = 'E5', ['181'] = '75', ['182'] = 'C3', ['183'] = '99', ['184'] = 'E9', ['185'] = '64', ['186'] = 'A9', ['187'] = 'E2', ['188'] = '9E', ['189'] = 'B0', ['190'] = 'EC', ['191'] = 'C7', ['192'] = '80', ['193'] = 'F0', ['194'] = 'BA', ['195'] = '55', ['196'] = '3E', ['197'] = 'BC', ['198'] = '5B', ['199'] = '1D', ['200'] = '7A', ['201'] = 'E1', ['202'] = '4F', ['203'] = '16', ['204'] = '0E', ['205'] = 'DD', ['206'] = 'F7', ['207'] = '5C', ['208'] = '10', ['209'] = 'FE', ['210'] = 'A6', ['211'] = 'B5', ['212'] = '78', ['213'] = '0F', ['214'] = 'A3', ['215'] = 'FC', ['216'] = '51', ['217'] = '11', ['218'] = '43', ['219'] = 'EB', ['220'] = 'A5', ['221'] = '33', ['222'] = 'DB', ['223'] = '77', ['224'] = '3C', ['225'] = 'F4', ['226'] = 'C5', ['227'] = 'DC', ['228'] = 'FA', ['229'] = '9C', ['230'] = '4B', ['231'] = '88', ['232'] = 'B7', ['233'] = '14', ['234'] = '26', ['235'] = 'AB', ['236'] = '81', ['237'] = 'CD', ['238'] = '22', ['239'] = 'F2', ['240'] = '12', ['241'] = '47', ['242'] = '08', ['243'] = '7C', ['244'] = 'E3', ['245'] = '52', ['246'] = '7D', ['247'] = '76', ['248'] = 'AE', ['249'] = '8B', ['250'] = '32', ['251'] = 'BD', ['252'] = '1F', ['253'] = '25', ['254'] = '48', ['255'] = '05'}

-- 创建一个支持 0 键访问的代理表
local function createZeroIndexedProxy(tbl)
  if type(tbl) ~= "table" then
    error("必须传入table")
  end
  return setmetatable({}, {
    __index = function(_, key)
      --静态表 代码写的没问题 无需异常判断
      return rawget(tbl, key + 1)
    end,
    __newindex = function(_, key, value)
      error("禁止修改只读表", 2)
    end
  })
end

-- 创建一个支持将键转为字符串访问的代理表
local function createStringKeyProxy(tbl)
  if type(tbl) ~= "table" then
    error("必须传入table")
  end
  return setmetatable({}, {
    __index = function(_, key)
      return rawget(tbl, tostring(key))
    end,
    __newindex = function(_, key, value)
      error("禁止修改只读表", 2)
    end
  })
end

-- 批量创建代理表的辅助函数
local function createProxies(proxy,...)
  local proxies = {}
  for _, tbl in ipairs({...}) do
    table.insert(proxies, proxy(tbl))
  end
  return table.unpack(proxies)
end

-- 代理表支持从0开始访问table
_keySchedule,_sBox=createProxies(createZeroIndexedProxy,_keySchedule,_sBox)
-- 代理表支持数字转string访问表
_roundConstants, dict1, dict2,dict3,dict4,dict5 = createProxies(createStringKeyProxy,_roundConstants, dict1, dict2,dict3,dict4,dict5)

-- Hex 编码：字节数组 → 十六进制字符串
local function bytesToHex(bytes)
  local hexString = ""
  for _, byte in ipairs(bytes) do
    hexString = hexString .. string.format("%02x", byte)
  end
  return hexString
end

-- Hex 解码：十六进制字符串 → 字节数组
local function hexToBytes(hexString)
  -- 处理奇数长度情况
  if #hexString % 2 ~= 0 then
    hexString = "0"..hexString
  end
  local bytes = {}
  for i = 1, #hexString, 2 do
    local byte_str = hexString:sub(i, i+1)
    table.insert(bytes, tonumber(byte_str, 16))
  end
  return bytes
end

-- 大数异或核心函数
local function big_xor(hex1, hex2)
  -- 转换为字节数组
  local bytes1 = hexToBytes(hex1)
  local bytes2 = hexToBytes(hex2)

  -- 对齐长度（前补零）
  local max_len = math.max(#bytes1, #bytes2)
  while #bytes1 < max_len do table.insert(bytes1, 1, 0) end
  while #bytes2 < max_len do table.insert(bytes2, 1, 0) end

  -- 逐字节异或
  local result = {}
  for i = 1, max_len do
    result[i] = bit32.bxor(bytes1[i], bytes2[i])
  end

  return bytesToHex(result)
end

-- 模拟 BigInt 处理函数 将 hex 转换为 4x4 矩阵
local function hex_to_matrix(hex)
  local matrix = {{}, {}, {}, {}}
  for i = 1, #hex, 2 do
    local byte_str = hex:sub(i, i+1)
    local byte = tonumber(byte_str, 16)
    local row = math.floor((i-1)/8) + 1
    table.insert(matrix[row], byte)
  end
  return matrix
end

-- XOR 操作模板
local function xorArrayTemplate(a1, a2, lookup)
  local result = {}
  for i = 1, #a1 do
    local p1 = bit32.band(a2[i], 0xF) ~ bit32.band(bit32.lshift(a1[i], 4), 0xFF)
    --lua索引从1开始 createZeroIndexedProxy已经使用元表处理支持从0开始读取索引
    local v1 = bit32.rshift(lookup(p1), 4)
    local p2 = bit32.band(bit32.rshift(a2[i], 4), 0xF) ~ bit32.lshift(bit32.rshift(a1[i], 4), 4)
    --lua索引从1开始 createZeroIndexedProxy已经使用元表处理支持从0开始读取索引
    local v2 = bit32.rshift(lookup(p2), 4)
    table.insert(result, bit32.bxor(v1, bit32.lshift(v2, 4)))
  end
  return result
end


-- 添加轮密钥
local function addRoundKeys(state, round_key, lookup)
  local result = {{}, {}, {}, {}}
  for i = 1, 4 do
    result[i] = xorArrayTemplate(state[i], round_key[i], lookup)
  end
  return result
end

-- 处理状态矩阵
local function processState(state1, state2, lookup, mask1, mask2)
  local result = {}
  for i = 1, 4 do
    local rowResult = {}
    for j = 1, 4 do
      local p1 = bit32.bxor(bit32.band(state2[i][j], mask1), bit32.band(bit32.lshift(state1[i][j], 4), 0xFF))
      --lua索引从1开始 createZeroIndexedProxy已经使用元表处理支持从0开始读取索引
      local v1 = bit32.band(bit32.rshift(lookup(p1), 4), 0xFF)
      local p2 = bit32.bxor(bit32.band(bit32.rshift(state2[i][j], 4), mask2), bit32.lshift(bit32.rshift(state1[i][j], 4), 4))
      --lua索引从1开始 createZeroIndexedProxy已经使用元表处理支持从0开始读取索引
      local v2 = bit32.band(bit32.rshift(lookup(p2), 4), 0xFF)
      table.insert(rowResult, bit32.bxor(v1, bit32.lshift(v2, 4)))
    end
    table.insert(result, rowResult)
  end
  return result
end

-- AES 子操作
local subBytes = function(s1, s2)
  return processState(s1, s2, function(i) return _sBox[i] end, 0xF, 0xFF)
end

local shiftRows = function(s, s3)
  return processState(s, s3, function(i) return _sBox[i] end, 0xF, 0xF)
end

local mixColumns = function(s, s4)
  return processState(s, s4, function(i) return _sBox[i] end, 0xF, 0xF)
end

-- 构建密钥
local function buildKey(template, indices, source)
  local parts = {}
  for _, i in ipairs(indices) do
    --lua截取字符串开始是1 所以加1
    local startpos=i+1
    --i+2是因为lua是从start截取到end 并非到end就结束截取
    local index = tonumber(source:sub(startpos, i+2), 16) * 4
    --dict的key都是string createStringKeyProxy已经使用元表处理支持number转string键值
    table.insert(parts, template[index])
  end
  return table.concat(parts)
end

-- 状态矩阵转字符串
local function stateToString(state)
  local parts = {}
  for _, row in ipairs(state) do
    for _, byte in ipairs(row) do
      table.insert(parts, string.format("%02x", byte))
    end
  end
  return table.concat(parts)
end

local function encrypt(input, mkeySchedule)
  local state = addRoundKeys(hex_to_matrix(input), {mkeySchedule[1], mkeySchedule[2], mkeySchedule[3], mkeySchedule[4]}, function(i) return _keySchedule[i] end)
  local keyTemplates = {
    {template = dict1, indices = {0, 8, 16, 24}},
    {template = dict2, indices = {10, 18, 26, 2}},
    {template = dict3, indices = {20, 28, 4, 12}},
    {template = dict4, indices = {30, 6, 14, 22}},
  }

  local states = {}
  for _, t in ipairs(keyTemplates) do
    local hexData = buildKey(t.template, t.indices, stateToString(state))
    table.insert(states, hex_to_matrix(hexData))
  end


  for i = 1, 9 do
    state = addRoundKeys(mixColumns(shiftRows(subBytes(states[1], states[2]), states[3]), states[4]),
    {mkeySchedule[4 * i + 1], mkeySchedule[4 * i + 2], mkeySchedule[4 * i + 3], mkeySchedule[4 * i + 4]},
    function(i) return _sBox[i] end)

    if i ~= 9 then
      states = {}
      for _, t in ipairs(keyTemplates) do
        local hexData = buildKey(t.template, t.indices, stateToString(state))
        table.insert(states, hex_to_matrix(hexData))
      end
    end
  end

  local finalIndices = {0, 10, 20, 30, 8, 18, 28, 6, 16, 26, 4, 14, 24, 2, 12, 22}
  local newKeyParts = {}
  for _, i in ipairs(finalIndices) do
    local index = tonumber(stateToString(state):sub(i + 1, i + 2), 16)
    --dict的key都是string createStringKeyProxy已经使用元表处理支持number转string键值
    table.insert(newKeyParts, dict5[index])
  end
  local newKey = table.concat(newKeyParts)


  return addRoundKeys(hex_to_matrix(newKey), {mkeySchedule[41], mkeySchedule[42], mkeySchedule[43], mkeySchedule[44]},
  function(i) --_roundConstants的key都是string createStringKeyProxy已经使用元表处理支持number转string键值
    return tonumber(_roundConstants[i], 16) end)
end

-- 加密函数
local function aesEncrypt(inputHex, ivHex)
  -- 魔改aes加密 固定轮密钥 标准的aes可以推出后面的轮密钥
  local roundKeys = {
    "8cc1bbc96bc566b80528b0777044afe8",
    "475bb7b8d7f563bb1d906c77817f05f1",
    "ee0c4b61cf4fd3619a744038a4b0f887",
    "036de86538dacfb2d951843df75d3cf5",
    "fb0ead3988157a3f2a2211ba9c18e9fe",
    "73d212241f0183a05d757ea66e80f0d8",
    "260b251051b1d44bb07252166917c70e",
    "ecdd96f9a9d03d09ae5748d5002b811a",
    "35457064266861a73891d7fdc5f1286f",
    "87a52a68d300c4019fede9401c704ad4",
    "edd9095dc91e3780123c14cbb663a1e4"
  }

  local inputWithIV = big_xor(inputHex,ivHex)

  local mkeySchedule = {}
  for _, roundKey in ipairs(roundKeys) do
    local bytes = hexToBytes(roundKey)
    for i = 1, #bytes, 4 do
      table.insert(mkeySchedule, {bytes[i], bytes[i + 1], bytes[i + 2], bytes[i + 3]})
    end
  end
  local cipherState = encrypt(inputWithIV, mkeySchedule)
  local cipherText = stateToString(cipherState)
  print('Encrypted: ' .. cipherText)
  return cipherText
end

local function transform(inputArr, lookupTable)
  local result = {}
  for _, byte in ipairs(inputArr) do
    table.insert(result, lookupTable[byte + 1]) -- Lua表
  end
  return result
end

-- getmd5 获取md5值
local function getMd5(url)
  local md5str = md5.sumhexa(url)
  return md5str
end

-- 填充数据
local function pad_data(bytes)
  local block_size = 16
  -- 计算需要填充的长度
  local padding_length = block_size - (#bytes % block_size)
  if padding_length == block_size then
    padding_length = block_size
  end
  -- 根据填充长度选择填充字节
  local fill_byte = ({0xB9, 0xBA, 0xB8, 0xB3, 0xB1, 0xB2, 0xB0, 0xBF, 0xBD, 0xBE, 0xBC, 0xB7, 0xB5, 0xB6, 0xB4, 0x9B })[padding_length]
  -- 填充数据
  for _ = 1, padding_length do
    bytes[#bytes + 1] = fill_byte
  end

  return bytes
end

-- 主函数
local function myEncrypt(inputData)

  -- 查找表 (iArr 和 iArr2)
  local iArr = { 187, 185, 186, 184, 179, 177, 178, 176, 191, 189, 190, 188, 183, 181, 182, 180, 155, 153, 154, 152, 147, 145, 146, 144, 159, 157, 158, 156, 151, 149, 150, 148, 171, 169, 170, 168, 163, 161, 162, 160, 175, 173, 174, 172, 167, 165, 166, 164, 139, 137, 138, 136, 131, 129, 130, 128, 143, 141, 142, 140, 135, 133, 134, 132, 59, 57, 58, 56, 51, 49, 50, 48, 63, 61, 62, 60, 55, 53, 54, 52, 27, 25, 26, 24, 19, 17, 18, 16, 31, 29, 30, 28, 23, 21, 22, 20, 43, 41, 42, 40, 35, 33, 34, 32, 47, 45, 46, 44, 39, 37, 38, 36, 11, 9, 10, 8, 3, 1, 2, 0, 15, 13, 14, 12, 7, 5, 6, 4, 251, 249, 250, 248, 243, 241, 242, 240, 255, 253, 254, 252, 247, 245, 246, 244, 219, 217, 218, 216, 211, 209, 210, 208, 223, 221, 222, 220, 215, 213, 214, 212, 235, 233, 234, 232, 227, 225, 226, 224, 239, 237, 238, 236, 231, 229, 230, 228, 203, 201, 202, 200, 195, 193, 194, 192, 207, 205, 206, 204, 199, 197, 198, 196, 123, 121, 122, 120, 115, 113, 114, 112, 127, 125, 126, 124, 119, 117, 118, 116, 91, 89, 90, 88, 83, 81, 82, 80, 95, 93, 94, 92, 87, 85, 86, 84, 107, 105, 106, 104, 99, 97, 98, 96, 111, 109, 110, 108, 103, 101, 102, 100, 75, 73, 74, 72, 67, 65, 66, 64, 79, 77, 78, 76, 71, 69, 70, 68 }
  local iArr2 = { 0, 2, 1, 3, 8, 10, 9, 11, 4, 6, 5, 7, 12, 14, 13, 15, 32, 34, 33, 35, 40, 42, 41, 43, 36, 38, 37, 39, 44, 46, 45, 47, 16, 18, 17, 19, 24, 26, 25, 27, 20, 22, 21, 23, 28, 30, 29, 31, 48, 50, 49, 51, 56, 58, 57, 59, 52, 54, 53, 55, 60, 62, 61, 63, 128, 130, 129, 131, 136, 138, 137, 139, 132, 134, 133, 135, 140, 142, 141, 143, 160, 162, 161, 163, 168, 170, 169, 171, 164, 166, 165, 167, 172, 174, 173, 175, 144, 146, 145, 147, 152, 154, 153, 155, 148, 150, 149, 151, 156, 158, 157, 159, 176, 178, 177, 179, 184, 186, 185, 187, 180, 182, 181, 183, 188, 190, 189, 191, 64, 66, 65, 67, 72, 74, 73, 75, 68, 70, 69, 71, 76, 78, 77, 79, 96, 98, 97, 99, 104, 106, 105, 107, 100, 102, 101, 103, 108, 110, 109, 111, 80, 82, 81, 83, 88, 90, 89, 91, 84, 86, 85, 87, 92, 94, 93, 95, 112, 114, 113, 115, 120, 122, 121, 123, 116, 118, 117, 119, 124, 126, 125, 127, 192, 194, 193, 195, 200, 202, 201, 203, 196, 198, 197, 199, 204, 206, 205, 207, 224, 226, 225, 227, 232, 234, 233, 235, 228, 230, 229, 231, 236, 238, 237, 239, 208, 210, 209, 211, 216, 218, 217, 219, 212, 214, 213, 215, 220, 222, 221, 223, 240, 242, 241, 243, 248, 250, 249, 251, 244, 246, 245, 247, 252, 254, 253, 255 }

  -- Step 1: 使用 iArr 转换 并填充数据
  local byte1 = {}
  for c in inputData:gmatch(".") do
    table.insert(byte1, c:byte())
  end
  local res2 = pad_data(transform(byte1, iArr))

  -- Step 2: 转换为十六进制字符串 并分块
  local input = bytesToHex(res2)
  -- 分块处理，每32个字符为一个块
  local blocks = {}
  for i = 1, #input, 32 do
    table.insert(blocks, input:sub(i, i + 31))
  end

  -- Step 3: AES 加密
  local signatures = {}
  -- 初始 ivHex 是固定的
  local ivHex = '99303a3a32343a3992923a3b3a999292'
  for _, block in ipairs(blocks) do
    local signature = aesEncrypt(block, ivHex)
    table.insert(signatures, signature)
    ivHex = signature
  end

  -- 合并所有签名
  local final_signature = table.concat(signatures)
  print('Signatures: ' .. final_signature)

  -- Step 4: 使用 iArr2 转换
  local byteArr = hexToBytes(final_signature)
  local bArr = {}
  for _, i in ipairs(byteArr) do
    table.insert(bArr, i >= 0 and i or i + 256)
  end
  local res = transform(bArr, iArr2)

  -- Step 5: Base64 编码
  local base64Str = base64.encode(string.char(table.unpack(res)))
  print('Final Result: ' .. base64Str)
  return base64Str
end



-- 示例调用
-- 计算 MD5 哈希 接口大部分需要计算md5 如果是json字符串不需要计算
local md5Data = getMd5('test')
print('MD5 Hash: ' .. md5Data)
-- 如果加密的不是json 需要加上1.0_ 前缀
myEncrypt(md5Data)
